filter(species == "Adelie")
install.packages("ggplot2")
install.packages(“palmerpenguins”)
install.packages("palmerpenguins")
library(ggplot2)
library(palmerpenguins)
data("penguins")
View(penguins)
ggplot(data = penguins) + geom_point(mapping = aes(x = flipper_length_mm, y = body_mass_g))
install.packages("rmarkdown")
knitr::opts_chunk$set(echo = TRUE)
head(penguins)
head('penguins')
View(penguins)
View('penguins')
head('penguins')
head(palmerpenguins)
data (palmerpenguins)
data ('palmerpenguins')
data (package = 'palmerpenguins')
library(tidyverse)
library(palmerpenguins)
data ('palmerpenguins')
data ('penguins')
head(penguins)
ggplot(data = penguins)+
geom_point(mapping = aes(x= flipper_length_mm, y = body_mass_g, color = species))
ggplot(data = penguins)+
geom_point(mapping = aes(x= flipper_length_mm, y = body_mass_g, color = species))+
facet_wrap(~species)
library(tidyverse)
library(palmerpenguins)
data ('penguins')
head(penguins)
library(rmarkdown)
library(tinytex)
activity1 <- janitor::clean_names(activity)
library(tidyverse)
library(lubridate)
library(skimr)
library(dplyr)
library(janitor)
library(ggplot2)
library(selectr)
activity <- read.csv("dailyActivity_merged.csv")
calories <- read.csv("dailyCalories_merged.csv")
intensities <- read.csv("dailyIntensities_merged.csv")
steps <- read.csv("dailySteps_merged.csv")
sleepday <- read.csv("sleepDay_merged.csv")
Weight <- read.csv("weightLogInfo_merged.csv")
head(activity)
head(calories)
head(intensities)
head(steps)
head(sleepday)
head(Weight)
activity1 <- janitor::clean_names(activity)
calories1 <- janitor::clean_names(calories)
intensities1 <- janitor::clean_names(intensities)
steps1 <- janitor::clean_names(steps)
sleepday1 <- janitor::clean_names(sleepday)
Weight1 <- janitor::clean_names(Weight)
colnames(activity1)
colnames(calories1)
colnames(intensities1)
colnames(sleepday1)
colnames(steps1)
Is the Data ROCC?
activity1 %>%
n_distinct(activity$Id)
select(total_steps,
total_distance,
sedentary_minutes, calories) %>%
summary()
getwd()
setwd("~/Documents/Bellabeat _case_study/Files_used")
activity1 %>%
n_distinct(activity$Id)
select(total_steps,
total_distance,
sedentary_minutes, calories) %>%
summary()
# Bellbeat_Case_study
# Loading packages
library(tidyverse)
library(lubridate)
library(skimr)
library(dplyr)
library(janitor)
library(ggplot2)
library(selectr)
#(A) Preparing Data
#importing files
activity <- read.csv("dailyActivity_merged.csv")
calories <- read.csv("dailyCalories_merged.csv")
intensities <- read.csv("dailyIntensities_merged.csv")
steps <- read.csv("dailySteps_merged.csv")
sleepday <- read.csv("sleepDay_merged.csv")
Weight <- read.csv("weightLogInfo_merged.csv")
head(activity)
head(calories)
head(intensities)
head(steps)
head(sleepday)
head(Weight)
#data cleaning
#cleaning the  column names
activity1 <- janitor::clean_names(activity)
calories1 <- janitor::clean_names(calories)
intensities1 <- janitor::clean_names(intensities)
steps1 <- janitor::clean_names(steps)
sleepday1 <- janitor::clean_names(sleepday)
Weight1 <- janitor::clean_names(Weight)
colnames(activity1)
colnames(calories1)
colnames(intensities1)
colnames(sleepday1)
colnames(steps1)
# (B) Analyzing Data
#Summarizing data
#Checking sample size to decide whether to use for analysis
n_distinct(activity$Id)
n_distinct(calories$Id)
n_distinct(intensities$Id)
n_distinct(steps$Id)
n_distinct(sleepday$Id)
n_distinct(Weight$Id)
activity1 %>%
n_distinct(activity$Id)
select(total_steps,
total_distance,
sedentary_minutes, calories) %>%
summary()
activity1 %>%
select(total_steps,
total_distance,
sedentary_minutes, calories) %>%
summary()
activity1 %>%
n_distinct(activity$Id)%>%
select(total_steps,
total_distance,
sedentary_minutes, calories) %>%
summary()
colnames(sleepday1)
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleepday))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
View(sleepday1)
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_manual(low="red", high ="#008000")
class(sleepday1$sleep_day)
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = as.numeric(sleep_day)))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color sleep_day))+
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed(per each sleep-day)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = total_minutes_asleep))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.8))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.4))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.1))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 1))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.01))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.05))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.09))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.2))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep and Time in Bed(per each sleep_day)")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep Vs Time in Bed(per each sleep_day)")
ggplot(data = merged_data, aes(x=calories, y= total_steps))+
geom_point()+
geom_smooth()+
facet_wrap(~activity_date)+
labs(title = "Relationship Between Calories and Total Steps by Activity Date")+
theme(plot.title = element_text(hjust = 0.5))
# Relationship Between Calories and Total Steps by Activity Date
ggplot(data = merged_data, aes(x=calories, y= total_steps))+
geom_point()+
geom_smooth()+
facet_wrap(~activity_date)+
labs(title = "Relationship Between Calories and Total Steps by Activity Date")+
theme(plot.title = element_text(hjust = 0.5))
merged_data <- merge ( sleepday1, activity1, by = c('id', 'date'))
activity1$activity_date <- as.POSIXct(activity1$activity_date, format = "%m/%d/%Y", tz = Sys.timezone())
activity1$date <- format(activity1$activity_date, format = "%m/%d/%y")
# Formatting 'sleepday1' table
sleepday1$sleep_day <- as.POSIXct(sleepday1$sleep_day, format = "%m/%d/%Y %I:%M:%S %p", tz = Sys.timezone())
sleepday1$date <- format(sleepday1$sleep_day, format = "%m/%d/%y")
merged_data <- merge ( sleepday1, activity1, by = c('id', 'date'))
ggplot(data = merged_data, aes(x = total_steps, y = calories))+
geom_point(color = 'darkblue')+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data  = activity1)+
geom_point(mapping = aes(x = total_steps, y = calories), color = calories)+
geom_smooth(mapping = aes(x = total_steps, y = calories), method = 'loess')+
labs(title = "Relationship between the Total Steps taken Vs Calories burnt")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data  = activity1)+
geom_point(mapping = aes(x = total_steps, y = calories), color = 'blue')+
geom_smooth(mapping = aes(x = total_steps, y = calories), method = 'loess')+
labs(title = "Relationship between the Total Steps taken Vs Calories burnt")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x = total_steps, y = calories))+
geom_point(color = 'darkblue')+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data  = activity1)+
geom_point(mapping = aes(x = total_steps, y = calories), color = 'blue')+
geom_smooth(mapping = aes(x = total_steps, y = calories), method = 'loess')+
labs(title = "Relationship between the Total Steps taken Vs Calories burnt")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x = total_steps, y = calories))+
geom_point(color = 'darkblue')+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5))
colnames(merged_data)
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point(color = 'darkblue')+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
custom_theme()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element.rect(color = 'black',  fill = NA),
legend.box.background = element_rect(colour = "black"))
library(highcharter)
library(mytheme)
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element.rect(color = 'black',  fill = NA),
legend.box.background = element_rect(colour = "black"))
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.box.background = element_rect(colour = "black"))
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggplot(data  = activity1)+
geom_point(mapping = aes(x = total_steps, y = calories), color = 'blue')+
geom_smooth(mapping = aes(x = total_steps, y = calories), method = 'loess')+
labs(title = "Relationship between the Total Steps taken Vs Calories burnt")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggplot(data = merged_data, aes(x = total_steps, y = calories, color = calories))+
geom_point()+
geom_smooth()+
labs(title = 'Relationship between the Steps vs Calories')+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggplot(data = merged_data, aes(x=calories, y= total_steps))+
geom_point()+
geom_smooth()+
facet_wrap(~activity_date)+
labs(title = "Relationship Between Calories and Total Steps by Activity Date")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x = total_steps, y = sedentary_minutes))+
geom_point(color = "blue")+
geom_smooth()+
labs(title = "Sedentary Minutes vs Total steps Taken")+
theme(plot.title = element_text(hjust = 0.5))
ggplot(data = merged_data, aes(x=calories, y= total_steps))+
geom_point()+
geom_smooth()+
facet_wrap(~activity_date)+
labs(title = "Relationship Between Calories and Total Steps by Activity Date")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA))
ggplot(data = merged_data, aes(x = total_steps, y = sedentary_minutes))+
geom_point(color = "blue")+
geom_smooth()+
labs(title = "Sedentary Minutes vs Total steps Taken")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA))
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = total_minutes_asleep))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = total_minutes_asleep))+
geom_point()+
geom_smooth()+
labs(title = "Relationship Between Minutes Asleep and Time in Bed")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))+
scale_color_gradient(low="red", high ="#008000")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep Vs Time in Bed(per each sleep_day)")
ggplot(data = sleepday1, aes(x= total_minutes_asleep, y = total_time_in_bed, color = sleep_day))+
geom_point()+
geom_smooth()+
labs(title = " Minutes Asleep Vs Time in Bed(per each sleep_day)")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
view(sleep)
View(sleepday1)
View(activity1)
View(merged_data)
merged_df <- merged_data%>%
mutate(usertype = case_when(
.$total_steps < 5000 ~ "Sedentary",
.$total_steps >= 5000 & .$total_steps < 7499 ~ "Low_active",
.$total_steps >= 7500 & .$total_steps < 9999 ~ "Moderately_active",
.$total_steps >= 10000 & .$total_steps < 12499 ~ "Active",
.$total_steps >= 12500  ~ "very_active"
),sleepquality = case_when(
.$total_minutes_asleep/60 >= 6 & .$total_minutes_asleep/60 <= 8 ~"Sufficient Sleep",
.$total_minutes_asleep/60 >= 6  ~ "InSufficient Sleep",
.$total_minutes_asleep/60 > 9  ~ "OverSleeping"
)
)
head(merged_df)
View(merged_df)
merged_df <- merged_data%>%
mutate(usertype = case_when(
.$total_steps < 5000 ~ "Sedentary",
.$total_steps >= 5000 & .$total_steps < 7499 ~ "Low_active",
.$total_steps >= 7500 & .$total_steps < 9999 ~ "Moderately_active",
.$total_steps >= 10000 & .$total_steps < 12499 ~ "Active",
.$total_steps >= 12500  ~ "very_active"
),sleepquality = case_when(
.$total_minutes_asleep/60 >= 6 & .$total_minutes_asleep/60 <= 8 ~"Sufficient Sleep",
.$total_minutes_asleep/60 >= 6  ~ "InSufficient Sleep",
.$total_minutes_asleep/60 > 8  ~ "OverSleeping"
)
)
view(merged_df)
merged_df <- merged_data%>%
mutate(usertype = case_when(
.$total_steps < 5000 ~ "Sedentary",
.$total_steps >= 5000 & .$total_steps < 7499 ~ "Low_active",
.$total_steps >= 7500 & .$total_steps < 9999 ~ "Moderately_active",
.$total_steps >= 10000 & .$total_steps < 12499 ~ "Active",
.$total_steps >= 12500  ~ "very_active"
),sleepquality = case_when(
.$total_minutes_asleep/60 >= 6 & .$total_minutes_asleep/60 <= 8 ~"Sufficient Sleep",
.$total_minutes_asleep/60 < 6  ~ "InSufficient Sleep",
.$total_minutes_asleep/60 > 9  ~ "OverSleeping"
)
)
View(merged_df)
ggplot(data = merged_df, aes( x = usertype, fill = usertype))+
geom_bar()+
labs(title = "Usertype Distribution")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
merged_df <- merged_data%>%
mutate(user_type = case_when(
.$total_steps < 5000 ~ "Sedentary",
.$total_steps >= 5000 & .$total_steps < 7499 ~ "Low_active",
.$total_steps >= 7500 & .$total_steps < 9999 ~ "Moderately_active",
.$total_steps >= 10000 & .$total_steps < 12499 ~ "Active",
.$total_steps >= 12500  ~ "very_active"
),sleep_quality = case_when(
.$total_minutes_asleep/60 >= 6 & .$total_minutes_asleep/60 <= 8 ~"Sufficient Sleep",
.$total_minutes_asleep/60 < 6  ~ "InSufficient Sleep",
.$total_minutes_asleep/60 > 9  ~ "OverSleeping"
)
)
ggplot(data = merged_df, aes( x = user_type, fill = user_type))+
geom_bar()+
labs(title = "Usertype Distribution")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
ggplot(data = merged_df, aes( x = user_type, fill = user_type))+
geom_bar()+
labs(title = "User_type Distribution")+
theme(plot.title = element_text(hjust = 0.5),
panel.border = element_rect(color = 'black',  fill = NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"))
